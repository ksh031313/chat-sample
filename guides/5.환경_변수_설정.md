# 환경 변수 설정 가이드

이 가이드는 Azure 서비스 사용에 필요한 환경 변수를 구성하는 방법을 설명합니다.

## 초기 설정 

### 로그인 명령어 실행
   - 터미널에서 아래 명령어를 실행하여 Azure 계정에 로그인합니다.
     ```bash
     azd auth login
     ```
   - 브라우저가 열리며 Azure 계정 로그인 페이지로 이동합니다. 로그인 후 터미널로 돌아옵니다.

### 환경 초기화
   - azd env 명령어는 Azure Developer CLI(azd)에서 환경(Environment)을 관리하기 위해 사용됩니다.
   azd env 명령어를 사용하여 Azure 리소스 및 애플리케이션에 필요한 환경 변수를 설정하고 관리할 수 있습니다. 또한 추후 Azure 리소스 생성시 리소스 그룹명으로 사용됩니다.

   ```bash
   azd env {자신의 이니셜}-chat-sample
   ```

## 서비스 설정

### 주의사항
- Free Tier는 제한된 리소스를 제공하므로, 사용량에 따라 추가 비용이 발생할 수 있습니다.

### App Service 설정
   - 앱 배포를 App Service로 설정합니다.
   - App Service를 Free Tier로 설정합니다.
   ```bash
   azd env set DEPLOYMENT_TARGET appservice
   azd env set AZURE_APP_SERVICE_SKU F1
   azd env set AZURE_USE_APPLICATION_INSIGHTS false
   ```

### Azure AI Search 설정
   - Search Service를 Free Tier로 설정합니다.
   ```bash
   azd env set AZURE_SEARCH_SERVICE_SKU free
   ```

### 파서 설정
   - 파서는 문서의 내용을 분석하고 이해하는 데 사용됩니다.
   - Document Intelligence를 Free Tier로 설정합니다. 
   ```bash
   azd env set AZURE_DOCUMENTINTELLIGENCE_SKU F0
   ```

   - PDF 및 HTML 파서를 Document Intelligence 대신 로컬에서 사용하도록 설정합니다.
   ```bash
   azd env set USE_LOCAL_PDF_PARSER true
   azd env set USE_LOCAL_HTML_PARSER true
   ```

### 로그인 설정
   - 아래 명령어를 실행하여 인증 사용을 활성화합니다.
     ```bash
     azd env set AZURE_USE_AUTHENTICATION true
     ```

   - Azure 계정으로 앱 로그인을 할 수 있습니다.
   - 아래 명령어를 실행하여 Azure 인증 테넌트 ID를 설정합니다.

     ```bash
     azd env set AZURE_AUTH_TENANT_ID {본인_Azure_테넌트_ID}
     ```
   - *Azure 포털에서 Tenant properties 검색하고, Azure 테넌트 ID를 복사하여 사용합니다.*

### 챗 히스토리 설정
   - 아래 명령어를 실행하여 히스토리 사용을 활성화합니다.
     ```bash
     azd env set USE_CHAT_HISTORY_COSMOS true
     ```

   - 아래 명령어를 실행하여 Cosmos DB SKU를 무료로 설정합니다.
     ```bash
     azd env set AZURE_COSMOSDB_SKU free
     ```


## 모델 환경 변수 설정

### LLM 모델 설정
- ChatGPT 모델을 위한 환경 변수:
   ```bash
   azd env set AZURE_OPENAI_CHATGPT_DEPLOYMENT gpt-4o
   azd env set AZURE_OPENAI_CHATGPT_MODEL gpt-4o
   azd env set AZURE_OPENAI_CHATGPT_DEPLOYMENT_VERSION 2024-11-20
   azd env set AZURE_OPENAI_CHATGPT_DEPLOYMENT_SKU GlobalStandard
   azd env set AZURE_OPENAI_CHATGPT_DEPLOYMENT_CAPACITY 50
   ```

### 임베딩 모델 설정
- Embedding 모델을 위한 환경 변수:
   ```bash
   azd env set AZURE_OPENAI_EMB_MODEL_NAME text-embedding-ada-002
   azd env set AZURE_OPENAI_EMB_DIMENSIONS 1536
   azd env set AZURE_OPENAI_EMB_DEPLOYMENT_VERSION 2
   azd env set AZURE_OPENAI_EMB_DEPLOYMENT_SKU GlobalStandard
   azd env set AZURE_OPENAI_EMB_DEPLOYMENT_CAPACITY 350
   ```


